var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,n,g){a!=Array.prototype&&a!=Object.prototype&&(a[n]=g.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var n=0;return $jscomp.iteratorPrototype(function(){return n<a.length?{done:!1,value:a[n++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,n){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var g=0,b={next:function(){if(g<a.length){var d=g++;return{value:n(d,a[d]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};
$jscomp.polyfill=function(a,n,g,b){if(n){g=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var d=a[b];d in g||(g[d]={});g=g[d]}a=a[a.length-1];b=g[a];n=n(b);n!=b&&null!=n&&$jscomp.defineProperty(g,a,{configurable:!0,writable:!0,value:n})}};$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,g){return g})}},"es6","es3");
$jscomp.findInternal=function(a,n,g){a instanceof String&&(a=String(a));for(var b=a.length,d=0;d<b;d++){var r=a[d];if(n.call(g,r,d,a))return{i:d,v:r}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,g){return $jscomp.findInternal(this,a,g).v}},"es6-impl","es3");
(function(a){var n=function(b,d){this.$table=a(b);this.top=window.top.document;this.init(d)};n.prototype={$table:null,app:null,init:function(b){this.app=b;this.loadExtraFields(b.values);this.makeSortable();this.events()},loadOrders:function(b,d){try{var a=JSON.parse(b.field_order)}catch(w){}a||(a={});for(var c=this.$table[0].getElementsByTagName("tbody")[0],e=c.getElementsByTagName("tr"),h=[],f=document.createDocumentFragment(),g,l=0,p=e.length;l<p;++l)e[l].classList.contains("tb_no_sort")?g=e[l]:
h.push(e[l]);e=null;h.sort(function(b,c){var r=function(b){for(var a=d.length-1;-1<a;--a)if(d[a].label===b&&void 0!==d[a].order)return d[a].order;return!1};var f=b.classList.contains("tb_contact_new_row");var h=c.classList.contains("tb_contact_new_row");var e=f?b.getElementsByClassName("tb_new_field_textbox")[0].value:b.getElementsByClassName("tb_lb_option")[0].id;var k=h?c.getElementsByClassName("tb_new_field_textbox")[0].value:c.getElementsByClassName("tb_lb_option")[0].id;e=e.trim();k=k.trim();
e=void 0!==a[e]?a[e]:f?r(e):!1;k=void 0!==a[k]?a[k]:h?r(k):!1;return e-k});l=0;for(p=h.length;l<p;++l)f.appendChild(h[l]);for(f.appendChild(g);c.firstChild;)c.removeChild(c.firstChild);c.appendChild(f)},loadExtraFields:function(b){var d=this.$table[0].getElementsByClassName("tb_no_sort")[0];try{var a=JSON.parse(b.field_extra).fields}catch(f){}a||(a={fields:[]});for(var c=document.createDocumentFragment(),e=0,h=a.length;e<h;++e)c.appendChild(this.addField(a[e]));d.parentNode.insertBefore(c,d);this.loadOrders(b,
a)},events:function(){var b=this;this.$table.on("click.tb_contact",".tb_new_field_action",function(a){a.preventDefault();a.stopPropagation();a=this.closest(".tb_no_sort");a.parentNode.insertBefore(b.addField({}),a);b.$table.find("tbody").sortable("refresh");b.changeObject()}).on("change.tb_contact",".tb_new_field_type",function(){b.switchField(this);b.changeObject()}).on("click.tb_contact",".tb_add_field_option",function(a){a.preventDefault();a.stopPropagation();this.previousElementSibling.appendChild(b.render.getOptions([""]))}).on("keyup.tb_contact",
'.tb_contact_new_row input[type="text"], .tb_contact_new_row textarea',function(){b.changeObject()}).on("change.tb_contact",".tb_contact_new_row .tb_new_field_required",function(){b.changeObject()}).on("click.tb_contact",".tb_contact_value_remove,.tb_contact_field_remove",function(d){d.preventDefault();d.stopPropagation();this.classList.contains("tb_contact_value_remove")?a(this).closest("li").remove():a(this).closest(".tb_contact_new_row").remove();b.changeObject()})},makeSortable:function(){var b=
this;this.$table.find("tbody").sortable({items:"tr:not(.tb_no_sort)",placeholder:"ui-state-highlight",axis:"y",containment:"parent",update:function(){b.changeObject()}})},render:{call:function(b,a){return void 0===this[a]?this._default(b,a):this[a].call(this,b,a)},setType:function(b,a){b.setAttribute("data-type",a)},getText:function(b,a,r){var c=document.createElement(r);"textarea"!==r&&(c.type="tel"!==r?"text":"tel");b.value&&(c.value=b.value);c.className="tb_new_field_value tb_field_type_text";
this.setType(c,a);return c},"static":function(b,a){var d=this._default(b,"textarea");d.placeholder=tb_contact_l10n.static_text;this.setType(d,"static");return d},upload:function(a,d){return document.createElement("div")},getOptions:function(a){var b=document.createDocumentFragment(),r;for(r in a){var c=document.createElement("li"),e=document.createElement("a"),h=document.createElement("input"),f=document.createElement("i");h.type="text";h.className="tb_multi_option";h.value=a[r];e.className="tb_contact_value_remove";
e.href="#";f.className="ti ti-close";c.appendChild(h);e.appendChild(f);c.appendChild(e);b.appendChild(c)}return b},_default:function(a,d){if("text"===d||"textarea"===d||"tel"===d)return this.getText(a,d,"textarea"===d?d:"input");var b=document.createElement("ul"),c=document.createElement("a"),e=document.createDocumentFragment();b.appendChild(this.getOptions(a.value||[""]));e.appendChild(b);c.href="#";c.className="tb_add_field_option";c.textContent=tb_contact_l10n.add_option;this.setType(c,d);e.appendChild(c);
return e}},addField:function(a){var b=a.type?a.type:"text",r=document.createElement("tr"),c=document.createElement("td"),e=document.createElement("input"),h=document.createElement("td"),f=document.createElement("div"),g=document.createElement("select"),l=document.createDocumentFragment(),p=document.createElement("div"),n=document.createElement("div"),x=document.createElement("label"),m=document.createElement("input"),q=document.createElement("a"),u=document.createElement("i"),t=tb_contact_l10n.types,
k="tb_"+tb_app.Utils.generateUniqueID();p.className="control-input";n.className="tb_new_field";f.className="selectwrapper";g.className="tb_new_field_type tb_lb_option";r.className="tb_contact_new_row";e.type="text";e.className="tb_new_field_textbox";e.value=void 0===a.label?tb_contact_l10n.field_name:a.label;m.type="checkbox";m.className="tb_new_field_required";m.value="required";"static"===b&&(x.style.display="none");!0===a.required&&(m.checked=!0);q.className="tb_contact_field_remove";q.href="#";
u.className="ti ti-close";h.setAttribute("colspan","3");c.appendChild(e);r.appendChild(c);for(var v in t)c=document.createElement("option"),c.name=k,v===b&&(c.selected="selected"),c.value=v,c.textContent=t[v],l.appendChild(c);g.appendChild(l);f.appendChild(g);h.appendChild(f);p.appendChild(this.render.call(a,b));n.appendChild(p);x.appendChild(m);x.appendChild(document.createTextNode(tb_contact_l10n.req));n.appendChild(x);h.appendChild(n);q.appendChild(u);h.appendChild(q);r.appendChild(h);return r},
switchField:function(a){var b=a.value;a=a.closest("td").getElementsByClassName("control-input")[0];for(var g=a.closest(".tb_new_field").getElementsByClassName("tb_new_field_required")[0].parentNode;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(this.render.call({},b));g.style.display="static"===b?"none":""},changeObject:function(){for(var a=this.$table[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr"),d={fields:[]},g={},c=0,e=a.length;c<e;++c)if(a[c].classList.contains("tb_contact_new_row")){var h=
a[c].getElementsByClassName("tb_new_field_type")[0].options[a[c].getElementsByClassName("tb_new_field_type")[0].selectedIndex].value,f=a[c].getElementsByClassName("tb_new_field_textbox")[0].value.trim(),n="static"!==h&&!0===a[c].getElementsByClassName("tb_new_field_required")[0].checked;switch(h){case "text":case "textarea":case "static":case "tel":var l=a[c].getElementsByClassName("tb_new_field_value")[0].value.trim();break;case "radio":case "select":case "checkbox":l=[];for(var p=a[c].getElementsByClassName("control-input")[0].getElementsByTagName("input"),
w=0,x=p.length;w<x;++w){var m=p[w].value.trim();""!==m&&l.push(m)}}if(""!==l&&void 0!==l||""!==f)h={type:h,order:c},n&&(h.required=n),""!==f&&(h.label=f),void 0!==l&&""!==l&&0<l.length&&(h.value=l),d.fields.push(h)}else a[c].classList.contains("tb_no_sort")||(f=a[c].getElementsByClassName("tb_lb_option")[0].id,g[f]=c);a=this.top.getElementById("field_extra");a.value=JSON.stringify(d);d=JSON.stringify(g);this.top.getElementById("field_order").value=d;this.app.settings.field_order=d;Themify.triggerEvent(a,
"change")}};var g=null;tb_app.Constructor.contact_fields={render:function(a,d){var b=window.top;null===g&&(g=!0,b.Themify.LoadCss(tb_contact_l10n.admin_css,tb_contact_l10n.v));var c=document.createElement("table"),b=document.createElement("thead"),e=document.createElement("tbody"),h=document.createElement("tfoot"),f=document.createElement("tr"),y=document.createDocumentFragment(),l=a.options.head,p=a.options.body,w=a.options.foot,x={text:function(a,b,c){a={id:"field_"+a,placeholder:b,"class":"large",
type:"text"};c&&(a.help=c);return d.create([a])},checkbox:function(a){return d.create([{id:"field_"+a,new_line:!0,type:"checkbox",options:[{value:"",name:"yes"}]}])}},m;for(m in l){var q=document.createElement("th");q.textContent=l[m];y.appendChild(q)}f.appendChild(y);b.appendChild(f);y=document.createDocumentFragment();for(m in p){var u=document.createDocumentFragment();var f=document.createElement("tr"),t;for(t in l){q=document.createElement("td");var k=null;if("f"===t)k=document.createElement("span"),
q.textContent=p[m];else if("l"===t||"p"===t){if(k=m+"_",k+="l"===t?"label":"placeholder",k=x.text(k,"l"===t?p[m]:l.p),"l"===t&&"message"!==m){var v=document.createDocumentFragment();var z=x.checkbox(m+"_require");v.appendChild(k);z.querySelector(".tb_lb_option").appendChild(document.createTextNode(tb_contact_l10n.req));v.appendChild(z);k=v}}else"sh"===t&&(k=x.checkbox(m+"_active"));null!==k&&q.appendChild(k);u.appendChild(q)}f.appendChild(u);y.appendChild(f)}f=document.createElement("tr");q=document.createElement("td");
u=document.createElement("a");p=document.createElement("span");u.className="tb_new_field_action";u.href="#";p.className="ti-plus";u.appendChild(p);u.appendChild(document.createTextNode(a.new_row));q.setAttribute("colspan","4");q.appendChild(u);f.className="tb_no_sort";f.appendChild(q);y.appendChild(f);e.appendChild(y);for(m in w)if("align"!==m){u=document.createDocumentFragment();f=document.createElement("tr");for(t in l){q=document.createElement("td");k=null;if("f"===t)q.textContent=w[m];else if("l"===
t){p=x.text(m+"_label",w[m]);if("send"===m)v=document.createDocumentFragment(),k=d.select.render({id:w.align.id,options:w.align.options},d),v.appendChild(p),v.appendChild(k),v.appendChild(document.createTextNode(w.align.label)),k=v;else if("optin"===m){k=document.createDocumentFragment();var B=ThemifyConstructor.create([{type:"optin_provider",id:"optin"}]);k.appendChild(p);k.appendChild(B)}else k=p;v.appendChild(z)}else"sh"===t&&"send"!==m&&(k=x.checkbox(m+"_active"),console.log(tb_contact_l10n.captcha),
"captcha"===m&&""!==tb_contact_l10n.captcha&&k.querySelector("input").addEventListener("change",function(a){a=this.closest("td").previousElementSibling;if(!0===this.checked){var b=document.createElement("div");b.className="tb_captcha_message tb_field_error_msg";b.innerHTML=tb_contact_l10n.captcha;a.appendChild(b)}else a=a.getElementsByClassName("tb_captcha_message")[0],a.parentNode.removeChild(a)},{passive:!0}));null!==k&&q.appendChild(k);u.appendChild(q)}f.appendChild(u);y.appendChild(f)}h.appendChild(y);
c.className="contact_fields";c.appendChild(b);c.appendChild(e);c.appendChild(h);var l=f=b=e=h=p=w=null,A=function(a){var b=new n(c,d);Themify.body.one("themify_builder_lightbox_close",function(a){b.$table.off("click.tb_contact keyup.tb_contact change.tb_contact");b=null});document.removeEventListener("tb_editing_contact",A,{once:!0})};document.addEventListener("tb_editing_contact",A,{once:!0});return c}}})(jQuery);
